<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מערכת ניתוח ביצועים</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <header>
        <div id="logo">אסף שטנגל - מאמן מנטלי</div>
    </header>

    <main>
        <!-- מכולה ראשית לבחירת התפקיד -->
        <section id="role-selection-container">
            <div class="game-info-container">
                <h1>ברוך הבא למערכת ניתוח ביצועים</h1>
                <p>בחר את התפקיד שלך:</p>
                <div class="role-buttons">
                    <button class="role-button" onclick="selectRole('player')">שחקן</button>
                    <button class="role-button" onclick="selectRole('coach')">מאמן</button>
                    <button class="role-button" onclick="selectRole('analyst')">אנליסט</button>
                </div>
            </div>
        </section>

        <!-- עבור שחקן -->
        <section id="login-container" class="hidden game-info-container">
            <h2>כניסת שחקן</h2>
            <p>הכנס קוד גישה:</p>
            <div class="input-group">
                <input type="text" id="access-code" placeholder="קוד גישה">
                <button onclick="checkAccessCode()">אישור</button>
            </div>
        </section>

        <section id="user-input-container" class="hidden game-info-container">
            <h2>פרטי שחקן</h2>
            <div class="input-group">
                <input type="text" id="player-name" placeholder="שם השחקן">
                <input type="text" id="team-name" placeholder="שם הקבוצה">
                <select id="player-position">
                    <option value="" selected disabled>בחר תפקיד</option>
                    <option value="שוער">שוער</option>
                    <option value="בלם">בלם</option>
                    <option value="מגן">מגן</option>
                    <option value="קשר">קשר</option>
                    <option value="חלוץ">חלוץ</option>
                    <option value="כנף">כנף</option>
                </select>
                <button onclick="submitUserInfo()">התחל</button>
            </div>
        </section>

        <section id="actions-selection-container" class="hidden game-info-container">
            <h2>בחירת פעולות</h2>
            <p>בחר בין 6 ל-10 פעולות להתמקד בהן.</p>
            <h3>פעולות מקצועיות:</h3>
            <div class="actions-grid" id="professional-actions"></div>
            <h3>פעולות מנטאליות:</h3>
            <div class="actions-grid" id="mental-actions"></div>
            <h3>פעולות מותאמות אישית:</h3>
            <div class="actions-grid" id="custom-actions"></div>
            <div class="input-group">
                <input type="text" id="custom-action-input" placeholder="הוסף פעולה מותאמת אישית">
                <button onclick="addCustomAction()">הוסף פעולה</button>
            </div>
            <button onclick="confirmActions()">אישור</button>
        </section>

        <section id="start-game-container" class="hidden game-info-container">
            <h2>התחלת משחק</h2>
            <button class="start-game-btn" onclick="startGame()">התחל משחק</button>
        </section>

        <div id="game-timer" class="hidden">
            דקה: <span id="minute-counter">0</span>
        </div>

        <h2 id="actions-title" class="hidden">רישום פעולות</h2>

        <section id="notes-container" class="hidden">
            <button class="blue-btn" onclick="openGeneralNotePopup()">הוסף הערה</button>
        </section>

        <section id="game-actions-container" class="hidden">
            <h3>פעולות מקצועיות:</h3>
            <div id="prof-actions-chosen"></div>
            <h3>פעולות מנטאליות:</h3>
            <div id="mental-actions-chosen"></div>
            <h3>פעולות מותאמות אישית:</h3>
            <div id="custom-actions-chosen"></div>
        </section>

        <div id="end-buttons-container" class="hidden">
            <button id="end-half" class="half-time-btn" onclick="endHalfTime()">סיום מחצית</button>
            <button id="end-game" class="end-game-btn" onclick="endGame()">סיום משחק</button>
        </div>

        <!-- פופאפ סיכום מחצית -->
        <div id="half-time-summary-popup" class="popup">
            <span class="close-btn" onclick="resumeHalf()">X</span>
            <div class="popup-content">
                <div id="half-summary-content"></div>
                <div id="half-general-note-display">
                    <h3>הערות מחצית:</h3>
                    <ul id="half-parent-notes-list"></ul>
                </div>
            </div>
        </div>

        <!-- פופאפ סיכום משחק -->
        <div id="game-summary-popup" class="popup">
            <span class="close-btn" onclick="closePopup()">X</span>
            <div class="popup-content">
                <div id="summary-content"></div>
                <div id="general-note-display" class="hidden">
                    <h3>הערות:</h3>
                    <ul id="parent-notes-list"></ul>
                </div>
                <button class="view-all-btn" onclick="showAllActions()">צפה בכל הפעולות</button>
                <button class="blue-btn" onclick="downloadPDF()">שמור כ-PDF</button>
            </div>
        </div>

        <!-- פופאפ פירוט כל הפעולות -->
        <div id="actions-detail-popup" class="popup">
            <span class="close-btn big-close" onclick="closeAllActionsPopup()">X</span>
            <div class="popup-content">
                <h3>כל הפעולות</h3>
                <div id="all-actions-list"></div>
            </div>
        </div>

        <!-- פופאפ הוספת הערה כללית בזמן משחק -->
        <div id="general-note-popup" class="popup">
            <span class="close-btn" onclick="closeGeneralNotePopup()">X</span>
            <div class="popup-content">
                <h3>הוסף הערה:</h3>
                <textarea id="general-note-text"></textarea>
                <button class="blue-btn" onclick="saveGeneralNote()">שמור הערה</button>
            </div>
        </div>

        <!-- פופאפ משוב -->
        <div id="feedback-popup" class="popup hidden">
            <span class="close-btn" onclick="closeFeedbackPopup()">X</span>
            <div class="popup-content">
                <h3>משוב</h3>
                <p id="feedback-text"></p>
            </div>
        </div>

        <div id="reopen-summary-container" class="hidden">
            <button class="blue-btn" onclick="reopenSummary()">פתח שוב את הסיכום</button>
        </div>

        <div id="popup" class="hidden"></div>

        <!-- עבור מאמן (coach) -->
        <section id="coach-game-info-container" class="hidden game-info-container">
            <h2>הגדרת משחק למאמן</h2>
            <div class="input-group">
                <input type="text" id="coach-teamA" placeholder="שם קבוצה א'">
                <input type="text" id="coach-teamB" placeholder="שם קבוצה ב'">
                <input type="date" id="coach-game-date">
            </div>
            <h3>צבע קבוצה א'</h3>
            <div id="coach-teamA-color-palette" class="color-palette"></div>
            <h3>צבע קבוצה ב'</h3>
            <div id="coach-teamB-color-palette" class="color-palette"></div>
            <!-- כאן תוכלו להוסיף כפתורי התחלה/שמירה וכו' -->
        </section>

        <!-- עבור אנליסט (analyst) -->
        <section id="analyst-game-info-container" class="hidden game-info-container">
            <h2>הגדרת משחק לאנליסט</h2>
            <div class="input-group">
                <input type="text" id="analyst-teamA" placeholder="שם קבוצה א'">
                <input type="text" id="analyst-teamB" placeholder="שם קבוצה ב'">
                <input type="date" id="analyst-game-date">
                <button onclick="submitAnalystGameInfo()">אישור</button>
            </div>
            <h3>צבע קבוצה א'</h3>
            <div id="teamA-color-palette" class="color-palette"></div>
            <h3>צבע קבוצה ב'</h3>
            <div id="teamB-color-palette" class="color-palette"></div>
        </section>

        <section id="analyst-setup-container" class="hidden game-info-container">
            <h2>הוספת שחקנים</h2>
            <div class="input-group">
                <input type="text" id="analyst-player-name" placeholder="שם השחקן">
                <input type="text" id="analyst-player-number" placeholder="מס' חולצה">
                <select id="analyst-player-position">
                    <option value="" disabled selected>בחר תפקיד</option>
                    <option value="שוער">שוער</option>
                    <option value="בלם">בלם</option>
                    <option value="מגן">מגן</option>
                    <option value="קשר">קשר</option>
                    <option value="חלוץ">חלוץ</option>
                    <option value="כנף">כנף</option>
                </select>
                <select id="analyst-player-team-select"></select>
                <button id="add-player-btn" class="blue-btn" disabled onclick="addAnalystPlayer()">הוסף שחקן</button>
            </div>
            <h3>שחקנים שנוספו:</h3>
            <div id="analyst-players-list"></div>
            <button class="blue-btn" onclick="submitAnalystSetup()">הבא</button>
        </section>

        <section id="analyst-actions-container" class="hidden game-info-container">
            <h2>בחירת פעולות לאנליסט</h2>
            <div id="analyst-players-actions"></div>
            <button class="blue-btn" onclick="submitAnalystActions()">הבא</button>
        </section>

        <section id="analyst-marking-container" class="hidden game-info-container">
            <h2>רישום פעולות בזמן אמת (אנליסט)</h2>
            <div id="analyst-marking-players"></div>
            <textarea id="analyst-general-note" placeholder="הערה כללית (לא חובה)"></textarea>
            <button class="blue-btn" onclick="finishAnalystGame()">סיום משחק אנליסט</button>
        </section>

        <section id="analyst-final-summary-container" class="hidden game-info-container">
            <h2>סיכום משחק אנליסט</h2>
            <div id="analyst-final-data"></div>
            <button class="blue-btn" onclick="downloadPDF()">הורד PDF</button>
        </section>

    </main>

    <footer>
        <p>&copy; 2024 אסף שטנגל - כל הזכויות שמורות.</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
