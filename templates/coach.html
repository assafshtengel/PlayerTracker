<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מאמן</title>
    <script src="{{ url_for('static', filename='html2canvas.min.js') }}"></script>
    <script src="{{ url_for('static', filename='jspdf.umd.min.js') }}"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div id="logo">
        <span class="logo-text">אסף שטנגל - מאמן מנטלי</span>
    </div>

    <!-- מסך הגדרת פרטי המשחק (מאמן) -->
    <div id="coach-game-info-container" class="game-info-container">
        <h2>הגדרת פרטי המשחק (מאמן)</h2>
        <p>הזן שם קבוצה א', ב', תאריך וצבע לקבוצות:</p>
        <div class="input-group">
            <input type="text" id="coach-teamA" placeholder="שם קבוצה א' (מארחת)">
            <h4>בחר צבע לקבוצה א':</h4>
            <div id="coach-teamA-colors" class="color-palette-group"></div>

            <input type="text" id="coach-teamB" placeholder="שם קבוצה ב' (אורחת)">
            <h4>בחר צבע לקבוצה ב':</h4>
            <div id="coach-teamB-colors" class="color-palette-group"></div>

            <input type="date" id="coach-game-date" />
        </div>
        <button id="submit-coach-game-info-btn" class="blue-btn" onclick="submitCoachGameInfo()">המשך</button>
    </div>

    <!-- מסך הגדרת מטרות לחוליות -->
    <div id="coach-setup-container" class="game-info-container hidden">
        <h2>הגדרת מעקב כמאמן - מטרות לחוליות</h2>
        <p>בחר מטרות, הוסף אם תרצה.</p>

        <div class="hoolia-section">
            <h3>שוער</h3>
            <div id="coach-goal-keeper" class="goals-container"></div>
            <div class="input-group" style="max-width:300px;margin:10px auto;">
                <input type="text" id="coach-goal-keeper-custom" placeholder="הוסף מטרה מותאמת...">
                <button class="blue-btn" onclick="addCoachGoal('goal-keeper')">הוסף מטרה</button>
            </div>
        </div>

        <div class="hoolia-section">
            <h3>הגנה</h3>
            <div id="coach-defense" class="goals-container"></div>
            <div class="input-group" style="max-width:300px;margin:10px auto;">
                <input type="text" id="coach-defense-custom" placeholder="הוסף מטרה מותאמת...">
                <button class="blue-btn" onclick="addCoachGoal('defense')">הוסף מטרה</button>
            </div>
        </div>

        <div class="hoolia-section">
            <h3>קישור</h3>
            <div id="coach-midfield" class="goals-container"></div>
            <div class="input-group" style="max-width:300px;margin:10px auto;">
                <input type="text" id="coach-midfield-custom" placeholder="הוסף מטרה מותאמת...">
                <button class="blue-btn" onclick="addCoachGoal('midfield')">הוסף מטרה</button>
            </div>
        </div>

        <div class="hoolia-section">
            <h3>התקפה</h3>
            <div id="coach-attack" class="goals-container"></div>
            <div class="input-group" style="max-width:300px;margin:10px auto;">
                <input type="text" id="coach-attack-custom" placeholder="הוסף מטרה מותאמת...">
                <button class="blue-btn" onclick="addCoachGoal('attack')">הוסף מטרה</button>
            </div>
        </div>

        <button class="blue-btn" style="background:#ff9800;color:white;" onclick="submitCoachSetup()">אישור ותחילת בחירת פעולות</button>
    </div>

    <!-- מסך מעקב במהלך המשחק (בזמן אמת) -->
    <div id="coach-tracking-container" class="game-info-container hidden">
        <h2>סימון פעולות שבוצעו והוספת הערות (מאמן)</h2>
        <p>לחץ על מטרה לציון מוצלח/לא מוצלח והוספת הערה. הפופאפ נסגר אוטומטית לאחר 4 שניות ללא אינטראקציה.</p>
        <div>דקה: <span id="coach-minute-counter">0</span></div>

        <h3>פתקים (Quick Notes)</h3>
        <div class="input-group" style="max-width:300px;margin:10px auto;">
            <input type="text" id="coach-quick-note-input" placeholder="תובנה קצרה...">
            <button class="blue-btn" onclick="addQuickNote()">הוסף פתק</button>
        </div>
        <div id="coach-quick-notes-list" style="margin-top:20px;"></div>

        <h3>מצב רוח הקבוצה (Mood)</h3>
        <select id="coach-mood-select" onchange="setTeamMoodInput()">
            <option value="">בחר מצב רוח...</option>
            <option value="מורל גבוה">מורל גבוה</option>
            <option value="חוסר ריכוז">חוסר ריכוז</option>
            <option value="נייטרלי">נייטרלי</option>
        </select>
        <div id="coach-mood-message-container" class="hidden" style="margin-top:10px;">
            <textarea id="coach-mood-message" placeholder="מסר לשחקנים..."></textarea>
        </div>

        <h3>לוח טקטי</h3>
        <button class="blue-btn" onclick="openTacticalBoard()">פתח לוח טקטי</button>

        <h3>מטרות שנבחרו</h3>
        <div id="coach-actions"></div>

        <button id="coach-end-half-btn" class="blue-btn" onclick="endCoachHalf()">סיים מחצית</button>
        <button id="coach-end-game-btn" class="blue-btn" style="background:red;" onclick="endCoachGame()">סיים משחק</button>
    </div>

    <!-- מסך סיכום המשחק -->
    <div id="coach-summary-container" class="game-info-container hidden">
        <h2>סיכום המשחק (מאמן)</h2>
        <div id="coach-summary-content"></div>
        <button class="blue-btn" onclick="savePDFCoach()">שמור כ-PDF</button>
        <button class="blue-btn" onclick="takeScreenshotCoach()">צלם מסך</button>
    </div>

    <!-- פופאפ טקטי -->
    <div id="tactical-board-popup" class="popup hidden">
        <div class="popup-content" style="position:relative;">
            <span class="close-btn" onclick="closeTacticalBoard()">&times;</span>
            <h3>לוח טקטי</h3>
            <div id="tactical-board" style="width:300px;height:400px;background:green;position:relative;">
                <!-- כאן אפשר להוסיף תמונה של מגרש או ציור -->
            </div>
            <button class="blue-btn" onclick="captureTacticalBoard()">צלם לוח</button>
        </div>
    </div>

    <!-- פופאפ לפעולה (מוצלח/לא מוצלח + הערה) -->
    <div id="coach-action-popup" class="popup hidden">
        <div id="coach-action-popup-header"></div>
        <span class="close-btn big-close" onclick="closeCoachActionPopup()">&times;</span>
        <div id="coach-action-popup-content" class="wide-popup">
            <div class="action-side red-side" onclick="chooseCoachActionResult('לא מוצלח')">לא מוצלח</div>
            <div class="action-side green-side" onclick="chooseCoachActionResult('מוצלח')">מוצלח</div>
        </div>
        <div id="coach-action-popup-footer">
            <textarea id="coach-action-popup-note" placeholder="הוסף הערה (אופציונלי)" oninput="coachUserInteractedWithPopup()"></textarea>
        </div>
    </div>

    <!-- פופאפ סיכום מחצית -->
    <div id="coach-half-summary-popup" class="popup hidden">
        <div class="popup-content">
            <span class="close-btn" onclick="closeCoachHalfSummary()">&times;</span>
            <div id="coach-half-summary-content"></div>
            <button class="blue-btn" onclick="resumeCoachHalf()">חידוש מחצית</button>
        </div>
    </div>

    <div id="popup" class="hidden"></div>

    <script src="{{ url_for('static', filename='script_coach.js') }}"></script>
</body>
</html>
